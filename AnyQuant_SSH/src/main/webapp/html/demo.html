<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">


    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
    <!--tab上的小图标-->
    <link rel="shortcut icon" href="/image/shoot_cut.png">
    <!--jQuery dependencies-->
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>

    <!--都是外面的css-->
    <!--fonts-->
    <link href='https://fonts.googleapis.com/css?family=Titillium+Web:200' rel='stylesheet' type='text/css'>
    <!-- jQuery -->
    <script type="text/javascript" charset="utf8" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <!-- DataTables -->
    <script type="text/javascript" charset="utf8" src="http://cdn.datatables.net/1.10.7/js/jquery.dataTables.js"></script>
    <!--<%&#45;&#45;表头css???奇葩&#45;&#45;%>-->
    <link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
    <!--<%&#45;&#45;tbody css&#45;&#45;%>-->
    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.7/css/jquery.dataTables.css">
    <link  rel="stylesheet" type="text/css" href ="http://cdn.datatables.net/plug-ins/28e7751dbec/integration/jqueryui/dataTables.jqueryui.css">
    <script type = "text/javascript" src = "http://cdn.datatables.net/plug-ins/28e7751dbec/integration/jqueryui/dataTables.jqueryui.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/StockList.css">
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Titillium+Web:200' rel='stylesheet' type='text/css'>
    <!--动画的css支持-->
    <link rel="stylesheet" type="text/css" href="/css/animate.css">
    <title>Title</title>
</head>
<body>
<div id="stock_list_container" class="stock_list_pane">
    <table id="stock_list" class="display">
        <thead>
        <tr>
            <th>股票名称</th>
            <th>股票代码</th>
            <th>开盘价</th>
            <th>最高价</th>
            <th>最低价</th>
            <th>收盘价</th>
            <th>成交量</th>
            <th>换手率</th>
        </tr>

        </thead>
        <tbody>
        </tbody>

        <tfoot>
        </tfoot>

    </table>
</div>
<script>
    var allStock;
    $(document).ready(function () {
                $.ajax({
                    type:'post',
                    url:'/Optional/get',
                    contentType:'application/json;charset=utf-8',
                    success:function (data){
                        initTable(data);
                    },
                    error:function () {
                        alert("请求失败");
                    }
                });
            }
    );
    /*
     *初始化table的方法,包括样式的配置
     */
    function initTable(allStock) {
        var table = $('#stock_list').DataTable( {

            data:allStock,
            columns:[
                {data:'name'},
                {data:'code'},
                {data:'open'},
                {data:'high'},
                {data:'low'},
                {data:'close'},
                {data:'turnoverVol'},
                {data:'changeRate'}
            ],
            /*
             *自适应宽度 默认true 关闭可提升性能,同时方便管理布局
             */
            "autoWidth":false,
            "columnDefs": [
                // 将name列变为红色
                {
                    "targets": [0], // 目标列位置，下标从0开始
                    "data": "name", // 数据列名
                    "render": function(data, type, full) { // 返回自定义内容
                        return "<span style='color:red;'>" + data + "</span>";
                    }
                }
            ],

        } );

//以下是关于选择行的代码

        $('#stock_list tbody').on( 'click', 'tr', function () {
            table.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
            var selected_row = table.row('.selected').index();
            var value = table.cell(selected_row,1).data();
            var myurl="/jsp/Stock_detail.jsp"+"?"+"code="+value;
            window.location.assign(myurl);
        } );
    }
</script>

</body>
</html>